CC = gcc
CFLAGS = -Wall -Wextra -Wpedantic -std=c11 -O2
LDFLAGS = -lncurses

SRC_APP = main.c board.c game.c ui.c
SRC_TEST = unittest.c board.c game.c

OBJ_APP = $(SRC_APP:.c=.o)
OBJ_TEST = $(SRC_TEST:.c=.o)

APP = viergewinn
TEST = tests

.PHONY: all clean run test format

all: $(APP)

$(APP): $(OBJ_APP)
    $(CC) $(CFLAGS) -o $@ $(OBJ_APP) $(LDFLAGS)

$(TEST): $(OBJ_TEST)
    $(CC) $(CFLAGS) -o $@ $(OBJ_TEST)

%.o: %.c header.h
    $(CC) $(CFLAGS) -c $< -o $@

run: $(APP)
    ./$(APP)

test: $(TEST)
    ./$(TEST)

clean:
    rm -f $(OBJ_APP) $(OBJ_TEST) $(APP) $(TEST)
